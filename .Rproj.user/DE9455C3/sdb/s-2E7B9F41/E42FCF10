{
    "collab_server" : "",
    "contents" : "calculateDE <- function(x, plot=FALSE){\n  exprs<-x\n  \n  dropouts <- rowSums(exprs==0)\n  dropout_proportion <- dropouts/ncol(exprs)\n  row_sums <- rowSums(exprs)\n  non_zeros <- ncol(exprs)-dropouts\n  means <- row_sums/non_zeros\n  \n  \n  model <- glm (dropout_proportion~means)\n  \n  p_x <- predict(model)\n  d_mean <- (1-p_x) * means\n  x_mean <- means\n  m <- non_zeros\n  n <- dropouts\n  s_mean<- ((m*d_mean)+(n*x_mean))/(n+m)\n  \n  mean_nofix <- rowMeans(exprs)\n  \n  remove_outliers <- function(x, na.rm = TRUE, ...) {\n    qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)\n    H <- 1.5 * IQR(x, na.rm = na.rm)\n    y <- x\n    y[x < (qnt[1] - H)] <- NA\n    y[x > (qnt[2] + H)] <- NA\n    y\n  }\n  \n  s_mean_2<-remove_outliers(s_mean)\n  mean_nofix_2<-remove_outliers(mean_nofix)\n  \n  if(plot==TRUE){\n    plot(s_mean_2, mean_nofix_2)   \n  }\n  \n  \n  return(s_mean_2)\n  \n}\n\n\ncalculateDV <- function(x, plot=FALSE){\n  exprs<-x\n  \n  dropouts <- rowSums(exprs==0)\n  dropout_proportion <- dropouts/ncol(exprs)\n  row_sums <- rowSums(exprs)\n  non_zeros <- ncol(exprs)-dropouts\n  means <- row_sums/non_zeros\n  \n  \n  model <- glm (dropout_proportion~means)\n  \n  p_x <- predict(model)\n  d_mean <- (1-p_x) * means\n  x_mean <- means\n  m <- non_zeros\n  n <- dropouts\n  s_mean<- ((m*d_mean)+(n*x_mean))/(n+m)\n  \n  d_sd <- (1-p_x) * means * means\n  standard_deviations <- numeric()\n  for(row in 1:nrow(exprs)){\n    exprs1<-as.matrix(exprs[row,])\n    exprs2<-as.matrix(exprs1[exprs1!=0])\n    standard_deviations[row]<-sd(exprs2)\n  }\n  \n  x_sd<-standard_deviations\n  \n  s_sd <- (((n*d_sd) +(m*x_sd))/(m+n)) + (((n*(d_mean-s_mean)*(d_mean-s_mean)) + (m*(x_mean-s_mean)*(x_mean-s_mean)))/(m+n))\n  sd_nofix <- apply(exprs,1,sd)\n  \n  \n  remove_outliers <- function(x, na.rm = TRUE, ...) {\n    qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)\n    H <- 1.5 * IQR(x, na.rm = na.rm)\n    y <- x\n    y[x < (qnt[1] - H)] <- NA\n    y[x > (qnt[2] + H)] <- NA\n    y\n  }\n  \n  s_sd_2<-remove_outliers(s_sd)\n  sd_nofix_2<-remove_outliers(sd_nofix)\n  \n  \n  \n  \n  if(plot==TRUE){\n    plot(s_sd_2, sd_nofix_2)\n  }\n  \n  \n  return(s_mean_2)\n  \n}\n",
    "created" : 1525851013844.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2991726638",
    "id" : "E42FCF10",
    "lastKnownWriteTime" : 1525850352,
    "last_content_update" : 1525850352,
    "path" : "~/DEandDV/R/DEandDV.R",
    "project_path" : "R/DEandDV.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}