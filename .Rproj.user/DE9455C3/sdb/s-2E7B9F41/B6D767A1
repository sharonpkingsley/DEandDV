{
    "collab_server" : "",
    "contents" : "source(\"https://bioconductor.org/biocLite.R\")\nbiocLite(\"splatter\")\nlibrary(splatter)\ninstall.packages(\"ggplot2\")\ninstall.packages(\"scater\")\n\n# installing/loading the latest installr package:\ninstall.packages(\"installr\"); library(installr) # install+load installr\n\nupdateR() # updating R.\nsetwd(\"D:/Documents/Uni/thesis a/New folder\")\n\n\nmat <- \"HUMAN_digital_expression.txt\"\nexprs <-as.matrix(read.table(mat, header=TRUE, sep=\"\\t\", row.names=1,as.is=TRUE))\ndropouts <- rowSums(exprs==0)\ndropout_proportion <- dropouts/ncol(exprs)\nrow_sums <- rowSums(exprs)\nnon_zeros <- ncol(exprs)-dropouts\nmeans <- row_sums/non_zeros\n\nplot(means,dropout_proportion_3)\ndropout_proportion_2 <- c(1,dropout_proportion)\nstep<-stepfun(sort(means), dropout_proportion_2, f=0)\nplot(step)\n\ndropout_proportion_3 <- apply(as.data.frame(dropout_proportion),2,function(x)ifelse((x>0.5),1,0))\ndropout_proportion\n \n \ninstall.packages('caTools')\nlibrary(caTools)\n\nmodel <- glm (dropout_proportion~means)\n \np_x <- predict(model) \np_x\nd_mean <- (1-p_x) * means\nx_mean <- means\nm <- non_zeros\nn <- dropouts\ns_mean<- ((m*d_mean)+(n*x_mean))/(n+m)\n\nmean_nofix <- rowMeans(exprs)\nplot(s_mean, mean_nofix)\ns_mean\nd_mean\np_x\nmeans\n\n\nd_sd <- (1-p_x) * means * means\nsd_all\n\nexprs[1,]\nexprs1<-exprs[1,]\nstandard_deviations <- numeric()\nfor(row in 1:nrow(exprs)){\n  exprs1<-as.matrix(exprs[row,])\n  exprs2<-as.matrix(exprs1[exprs1!=0])\n  standard_deviations[row]<-sd(exprs2)\n}\n\nx_sd<-standard_deviations\n\ns_sd <- (((n*d_sd) +(m*x_sd))/(m+n)) + (((n*(d_mean-s_mean)*(d_mean-s_mean)) + (m*(x_mean-s_mean)*(x_mean-s_mean)))/(m+n))\nsd_nofix <- apply(exprs,1,sd)\nplot(s_sd,sd_nofix)\nsd_nofix\nremove_outliers <- function(x, na.rm = TRUE, ...) {\n  qnt <- quantile(x, probs=c(.25, .75), na.rm = na.rm, ...)\n  H <- 1.5 * IQR(x, na.rm = na.rm)\n  y <- x\n  y[x < (qnt[1] - H)] <- NA\n  y[x > (qnt[2] + H)] <- NA\n  y\n}\ns_sd_2<-remove_outliers(s_sd)\nsd_nofix_2<-remove_outliers(sd_nofix)\nplot(s_sd_2, sd_nofix)\n\ns_mean_2<-remove_outliers(s_mean)\nmean_nofix_2<-remove_outliers(mean_nofix)\nplot(s_mean_2, mean_nofix_2)\n\n\n",
    "created" : 1525851099668.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4165669862",
    "id" : "B6D767A1",
    "lastKnownWriteTime" : 1525771078,
    "last_content_update" : 1525771078,
    "path" : "D:/Documents/Uni/thesis a/New folder/thesis.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}